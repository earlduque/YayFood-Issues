# YayFood 1.1.0 Release Notes

## üéâ What's New

### Gallery Filtering & Sorting
The Gallery view now features a comprehensive filtering and sorting system to help you find and view your favorite dishes exactly how you want!

#### Key Features:
- **Auto-Hiding Filter Button**: Floating filter button in the top-right corner that:
  - Fades out after 3 seconds of inactivity for an unobstructed photo view
  - Hides immediately when you take a screenshot
  - Reappears when you touch or scroll
  - Shows a blue badge when filters are active
- **Sort Options**:
  - Highest Rated / Lowest Rated
  - Newest First / Oldest First
- **Person Filter**: View dishes by specific family member's ratings or average ratings (horizontal scrolling pills)
- **Restaurant Filter**: Multi-select your favorite restaurants with:
  - Quick "All" and "None" buttons
  - Smart single-restaurant selection (tap one when all are selected)
- **Date Range Filter**: Filter dishes by review date with From/To date pickers
- **Filter Persistence**: All filter settings are saved between app sessions

#### How It Works:
1. Open the Gallery tab
2. Tap the floating filter button (slider icon) in the top-right
3. Configure your sort and filter preferences in the bottom sheet
4. Tap "Done" to apply
5. Use "Reset All Filters" to clear all settings at once

#### UI/UX Improvements:
- Clean bottom sheet interface with organized sections
- Smooth fade animations (0.3s) for the filter button
- Empty state with "Clear All Filters" button when no dishes match
- Accessibility labels for VoiceOver support
- Gallery person filter moved from Settings to Gallery for better discoverability

### Direct Save to Photos
You can now save your restaurant and dish cards directly to your Photos library with a single tap!

#### Key Features:
- **Two-Button Interface**: Choose between "Save to Photos" (green button) or "Share" (blue button) when exporting cards
- **Direct Save**: No need to navigate through the share sheet to find the save option
- **Smart Permissions**: Automatic permission handling with helpful prompts to enable Photos access if needed
- **Seamless Experience**: Successfully saved cards automatically close the export sheet
- **Permission Management**: Easy access to Settings if you need to adjust Photos permissions

#### How It Works:
1. Open any restaurant or dish detail view
2. Tap the share/export button
3. Configure your card settings (size, branding, etc.)
4. Choose your action:
   - **Save to Photos**: Directly saves the card image to your Photos library
   - **Share**: Opens the standard iOS share sheet for other sharing options

#### Technical Details:
- Uses iOS Photos framework for reliable saving
- Supports iOS 14+ with optimized add-only permission requests
- Graceful permission handling with clear error messages
- Maintains all existing export functionality (text-only mode still shows only Share button)

## üîß Under the Hood

### New Components:
- **GalleryFilterSheet**: Bottom sheet view with comprehensive filter controls
- **GallerySortOption**: Enum for gallery sort options (4 variants with display names and icons)
- **Auto-hide timer system**: Timer-based visibility management with screenshot detection
- **PhotoLibraryManager**: Centralized photo library access and permission handling
- **Enhanced CardExportSheet**: Two-button UI for improved user experience
- **Permission System**: Smart authorization flow with Settings integration

### Gallery View Enhancements:
- Added 6 new @AppStorage properties for filter persistence
- Implemented floating button with opacity-based visibility
- Enhanced filter logic in `allSortedDishesWithImages` computed property
- Added restaurant multi-select with smart selection behavior
- Empty state handling when filters produce no results
- onChange handlers for all filter properties to reset pagination

### Privacy:
- Added `NSPhotoLibraryAddUsageDescription` to Info.plist
- Uses minimum required permissions (add-only access on iOS 14+)
- Clear permission prompts explaining why access is needed

## üìù Notes

This release addresses two GitHub issues:
- [Issue #122](https://github.com/earlduque/YayFood/issues/122): Gallery filtering and sorting functionality
- [Issue #120](https://github.com/earlduque/YayFood/issues/120): Direct save to Photos for card exports

The implementation follows iOS best practices with:
- Proper permission handling
- User-friendly error messages
- Seamless integration with existing features
- No breaking changes to existing functionality

---

**Full Changelog**: [1.0.1...1.1.0](https://github.com/earlduque/YayFood/compare/1.0.1...1.1.0)

---

# YayFood 1.0.1

**Bug Fix Release**

This update fixes an issue that could prevent you from viewing your dishes properly.

## What's Fixed

### Smart Filter Reset
- **Fixed**: Problem where the dishes view could get stuck showing "no dishes yet" after deleting a family member's last rating
- **What happened**: If you were viewing dishes filtered by a specific family member and deleted their final rating, the filter would stay active but show no results
- **Now**: The app automatically switches back to showing "All" dishes when this happens, so you'll never get stuck in an empty view

## Improvements

- Better handling of family member filters when managing ratings
- Smoother experience when deleting ratings
- More reliable filtering behavior throughout the app
